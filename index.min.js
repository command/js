"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _axios=_interopRequireDefault(require("axios"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,o)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var CommandAPI=function(){function t(e){_classCallCheck(this,t),e||this._throwFormattedError("A valid API key is required."),this.apiKey=e,this.version="0.32.0",this.customerId=null,this.customers={login:this._loginCustomer.bind(this),logout:this._logoutCustomer.bind(this),create:this._createCustomer.bind(this),update:this._updateCustomer.bind(this),delete:this._deleteCustomer.bind(this)}}return _createClass(t,[{key:"_throwFormattedError",value:function(e){throw new Error("[Command] ".concat(e," See https://portal.oncommand.io/docs/command-js/").concat(this.version,"/introduction."))}},{key:"_request",value:function(e,t,r,o){var n=2<arguments.length&&void 0!==r?r:{},s=3<arguments.length&&void 0!==o?o:null;return(0,_axios.default)({method:e,url:"https://api.oncommand.io/v1".concat(t),headers:{"x-api-key":this.apiKey},data:n}).then(function(e){return callbak&&s(e),e}).catch(function(e){if(e&&e.response){var t=e.response.status,r=e.response&&e.response.data&&e.response.data&&e.response.data.data&&e.response.data.data.error;console.warn("[".concat(t,"] ").concat(r)),e.response.data&&console.warn(e.response.data)}})}},{key:"track",value:function(e,t){if(!e)throw new Error("Must pass a key to track.");var r={key:e};return this.customerId&&(r.customerId=this.customerId),t&&(r.properties=t),this._request("post","/behavior",r)}},{key:"_loginCustomer",value:function(e){if(!e)throw new Error("Must pass a customerId.");return this.customerId=e,this._request("put","/customers/login",{customerId:e})}},{key:"_logoutCustomer",value:function(){var e=this;if(!this.customerId)throw new Error("Must have a customerId to logout.");return this._request("put","/customers/logout",{customerId:this.customerId},function(){e.customerId=null})}},{key:"_createCustomer",value:function(e){if(!e)throw new Error("Must pass a customer.");return this._request("post","/customers",_objectSpread({},e))}},{key:"_updateCustomer",value:function(e,t){if(!e)throw new Error("Must pass a customerId.");if(!t)throw new Error("Must pass an update for the customer.");return this._request("put","/customers/".concat(e),_objectSpread({},t))}},{key:"_deleteCustomer",value:function(e){if(!e)throw new Error("Must pass a customerId.");return this._request("delete","/customers/".concat(e))}}]),t}();"object"===("undefined"==typeof window?"undefined":_typeof(window))&&(window.Command=CommandAPI);var _default=CommandAPI;exports.default=_default;